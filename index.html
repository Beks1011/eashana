<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Расписание 1-11 классы</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body{margin:0;font-family:Arial,Helvetica,sans-serif;background:linear-gradient(135deg,#a8e6cf,#dcedc1);overflow:hidden}
.header{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;margin-top:10px;position:relative}
h1{font-size:3rem;color:#064420;padding:10px 30px;border-radius:20px;margin:0;background:rgba(255,255,255,0.9);box-shadow:0 4px 12px rgba(0,0,0,0.1)}
.school-name{font-size:1rem;color:#064420;padding:6px 20px;border-radius:12px;background:rgba(255,255,255,0.9);box-shadow:0 3px 10px rgba(0,0,0,0.1);text-align:center;max-width:95%;}
.arrow-menu{cursor:pointer;background:rgba(255,255,255,0.9);padding:6px 10px;border-radius:12px;box-shadow:2px 2px 6px rgba(0,0,0,.2);position:absolute;left:10px;top:50%;transform:translateY(-50%);z-index:1002}
.menu-items{position:absolute;top:60px;left:10px;background:rgba(255,255,255,0.95);padding:10px;border-radius:12px;box-shadow:2px 2px 10px rgba(0,0,0,.3);z-index:1000;display:none;width:260px}
.menu-items button{display:block;width:100%;margin-bottom:6px;padding:10px;border-radius:12px;border:none;background:#064420;color:#fff;font-weight:600;cursor:pointer;transition:all 0.2s}
.menu-items button:hover{background:#046936}
#authInfo{padding:6px 4px;border-radius:6px;margin-bottom:6px;color:#111;background:transparent}
.time-container{position:fixed;top:10px;right:10px;z-index:1000;background:rgba(255,255,255,0.9);padding:6px 12px;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,.2);text-align:center;font-weight:700}
#clock{font-size:1.2rem}
.schedule-wrapper{width:100%;overflow:hidden;margin-top:12px;height:calc(100vh - 180px);position:relative;display:none}
.schedule-container{display:flex;gap:16px;padding:12px;height:100%;transition:transform .45s cubic-bezier(.2,.9,.2,1);align-items:flex-start}
.schedule-card{background:rgba(255,255,255,0.95);padding:16px;border-radius:24px;box-shadow:0 8px 20px rgba(0,0,0,.15);width:45%;min-width:45%;flex-shrink:0;display:flex;flex-direction:column;overflow:hidden;transition:transform 0.2s}
.schedule-card:hover{transform:scale(1.02)}
.schedule-card h3{text-align:center;margin:0 0 8px 0;font-size:1.3rem;color:#064420;font-weight:700}
table{width:100%;border-collapse:collapse;table-layout:fixed;font-size:0.9rem}
th,td{border:1px solid #ccc;text-align:center;vertical-align:middle;padding:6px;border-radius:8px}
th{background:#046936;color:#fff}
td select, td input{width:100%;padding:6px;font-size:0.85rem;border-radius:6px;border:1px solid #ccc;box-sizing:border-box}
.arrow-nav{position:absolute;top:50%;transform:translateY(-50%);background:rgba(255,255,255,0.9);padding:12px;border-radius:50%;cursor:pointer;box-shadow:2px 2px 6px rgba(0,0,0,.15);font-size:1.5rem;z-index:1001}
.arrow-left{left:8px}
.arrow-right{right:8px}
.popup{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(255,255,255,0.95);padding:20px;border-radius:20px;box-shadow:0 0 20px rgba(0,0,0,.3);z-index:1004;width:360px;max-width:92%}
.popup input, .popup button, .popup select, .popup textarea{margin:6px 0;padding:10px;border-radius:10px;border:1px solid #bdbdbd;box-sizing:border-box;width:100%;font-size:14px}
.btn{padding:10px 14px;border-radius:12px;border:none;background:#064420;color:#fff;cursor:pointer;font-weight:600;transition:all 0.2s}
.btn.gray{background:#046936;color:#fff}
.btn:hover{opacity:0.85}
.center{display:flex;justify-content:center;gap:8px;margin-top:8px}
.sep{height:8px;border:none}
.hidden-prelogin{display:none}
label.small{font-size:0.85rem;color:#333}
</style>
</head>
<body>

<div class="header">
  <div class="arrow-menu" id="menuArrow" title="Меню">☰</div>
  <h1>Расписание 1-11 классы</h1>
  <div class="school-name" id="schoolName" style="display:none;"></div>
  <div class="menu-items" id="menuItems" aria-hidden="true">
    <div id="authInfo" style="display:none"></div>
    <button id="saveBtn" class="hidden-prelogin btn">Сохранить</button>
    <button id="resetBtn" class="hidden-prelogin btn gray">Очистить</button>
    <button id="autoScrollBtn" class="hidden-prelogin btn gray">Автопрокрутка</button>
    <button id="fullscreenBtn" class="hidden-prelogin btn gray">Расширить/Назад</button>
    <button id="addClassBtn" class="hidden-prelogin btn">Добавить класс</button>
    <button id="selectClassesBtn" class="hidden-prelogin btn gray">Выбрать классы</button>
    <hr class="sep">
    <button id="createAdminBtn" class="hidden-prelogin btn gray" style="display:none">Создать админ-акк</button>
    <button id="createSchoolBtn" class="hidden-prelogin btn gray" style="display:none">Создать акк школы</button>
    <button id="logoutBtn" class="hidden-prelogin btn gray" style="display:none">Выйти</button>
  </div>
</div>

<div class="time-container" id="timeContainer">
  <span id="clock">00:00:00</span><br><span id="dateText"></span>
</div>

<div class="schedule-wrapper" id="scheduleWrapper" role="main">
  <div class="arrow-nav arrow-left" id="prevBtn" aria-label="Предыдущая страница">◀</div>
  <div class="arrow-nav arrow-right" id="nextBtn" aria-label="Следующая страница">▶</div>
  <div class="schedule-container" id="scheduleContainer" aria-live="polite"></div>
</div>

<div class="popup" id="loginPopup" role="dialog" aria-modal="true" style="display:block">
  <h3>Вход</h3>
  <input id="loginUsername" placeholder="Имя администратора или номер школы (например, 33)" />
  <input id="loginPassword" type="password" placeholder="Пароль" />
  <div class="center">
    <button id="loginBtn" class="btn">Войти</button>
  </div>
</div>

<script>
// === JS ФУНКЦИОНАЛ ===
const LS_SCHEDULE = "scheduleData_v1";
const LS_VISIBLE = "visibleClasses_v1";
const LS_USERS = "users_v1";
const LS_CURRENT = "current_user_v1";
const subjects = ["","Математика","Орыс тілі","Қазақ тілі","Физика","Химия","Биология","Тарих","География","Дене шынықтыру","Қолөнер","Музыка","Информатика","Ағылшын тілі","Қоғамтану"];
const letters = ["А","Б","В"];
let allClasses=[], scheduleData={}, visibleClasses=[], pageIndex=0, autoScroll=true;

// Инициализация данных
try { scheduleData = JSON.parse(localStorage.getItem(LS_SCHEDULE)||"{}"); } catch(e){ scheduleData = {}; }
try { visibleClasses = JSON.parse(localStorage.getItem(LS_VISIBLE)||"[]"); } catch(e){ visibleClasses = []; }
for(let i=1;i<=11;i++){letters.forEach(l=>{const cls=`${i}${l}`; allClasses.push(cls); if(!scheduleData[cls]){scheduleData[cls]={"Пн":[],"Вт":[],"Ср":[],"Чт":[],"Пт":[]}; for(const d in scheduleData[cls]) for(let k=0;k<8;k++) scheduleData[cls][d].push({subject:"",room:""});}})}
if(visibleClasses.length===0) visibleClasses=[...allClasses];

// Пользователи
let users = {
    "Бекарыс": {password:"123", role:"admin", displayName:"Бекарыс Мадениетов"},
    "school_33": {password:"abc", role:"school", displayName:"КГУ «Общеобразовательная школа №33 отдела образования г. Уральск Управления образования акимата Западно-Казахстанской области»", schoolNumber:"33"}
};
localStorage.setItem(LS_USERS, JSON.stringify(users));

let currentUser=null; try{currentUser=JSON.parse(localStorage.getItem(LS_CURRENT)||"null");}catch(e){currentUser=null;}

// Функции
function saveAll(){if(!currentUser) return; const key=currentUser.username; localStorage.setItem(LS_SCHEDULE, JSON.stringify(scheduleData)); localStorage.setItem(LS_VISIBLE, JSON.stringify(visibleClasses)); localStorage.setItem("user_"+key, JSON.stringify({schedule:scheduleData,visible:visibleClasses}));}
function updateSchoolName(){const div = document.getElementById('schoolName'); if(currentUser && currentUser.role==='school'){div.textContent = currentUser.displayName; div.style.display="block";} else { div.style.display="none"; }}
function updateClock(){const now=new Date();document.getElementById('clock').textContent=`${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}:${String(now.getSeconds()).padStart(2,'0')}`; document.getElementById('dateText').textContent=`${now.getDate()}.${now.getMonth()+1}.${now.getFullYear()}`;}
setInterval(updateClock,1000);updateClock();

// Создание карточек
const container = document.getElementById('scheduleContainer');
function createCard(cls){const card=document.createElement('div'); card.className='schedule-card'; card.dataset.cls=cls; let html=`<h3>${cls}</h3><table><thead><tr><th>#</th><th>Пн</th><th>Вт</th><th>Ср</th><th>Чт</th><th>Пт</th></tr></thead><tbody>`; for(let r=0;r<8;r++){html+=`<tr><td>${r+1}</td>`; ["Пн","Вт","Ср","Чт","Пт"].forEach(()=>{html+=`<td><select></select><input type="text" placeholder="кабинет"></td>`;}); html+=`</tr>`;} html+=`</tbody></table>`; card.innerHTML=html; container.appendChild(card); ["Пн","Вт","Ср","Чт","Пт"].forEach((day,i)=>{scheduleData[cls][day].forEach((lesson,rowIndex)=>{const td = card.querySelectorAll('tbody tr')[rowIndex].children[i+1]; const select = td.querySelector('select'); const input = td.querySelector('input'); subjects.forEach(s=>{const opt=document.createElement('option'); opt.value=s; opt.textContent=s||'—'; select.appendChild(opt);}); select.value=lesson.subject||''; input.value=lesson.room||''; select.addEventListener('change',()=>{lesson.subject=select.value; saveAll();}); input.addEventListener('input',()=>{lesson.room=input.value; saveAll();});});});}
allClasses.forEach(createCard);

function refreshVisibility(){document.querySelectorAll('.schedule-card').forEach(c=>c.style.display=visibleClasses.includes(c.dataset.cls)?'flex':'none'); updateSchedulePosition();}
function updateSchedulePosition(){const nodes=Array.from(container.children).filter(n=>visibleClasses.includes(n.dataset.cls)); if(nodes.length===0){container.style.transform=`translateX(0px)`; pageIndex=0; return;} const step=nodes[0].offsetWidth+16; const pages=Math.ceil(nodes.length/2); if(pageIndex>=pages) pageIndex=Math.max(pages-1,0); if(pageIndex<0) pageIndex=0; container.style.transform=`translateX(${-pageIndex*step}px)`;}
document.getElementById('nextBtn').addEventListener('click',()=>{pageIndex++; updateSchedulePosition();});
document.getElementById('prevBtn').addEventListener('click',()=>{pageIndex--; updateSchedulePosition();});
setInterval(()=>{if(autoScroll) document.getElementById('nextBtn').click();},5000);

// Меню и кнопки
const menuArrow=document.getElementById('menuArrow'); const menuItems=document.getElementById('menuItems');
menuArrow.addEventListener('click',()=>{menuItems.style.display=menuItems.style.display==='block'?'none':'block';});

document.getElementById('saveBtn').addEventListener('click',()=>{saveAll(); alert('Сохранено');});
document.getElementById('resetBtn').addEventListener('click',()=>{if(confirm('Очистить всё расписание?')){allClasses.forEach(cls=>{["Пн","Вт","Ср","Чт","Пт"].forEach(day=>{scheduleData[cls][day].forEach(lesson=>{lesson.subject='';lesson.room='';});});}); document.querySelectorAll('select,input').forEach(el=>el.value=''); saveAll();}});
document.getElementById('autoScrollBtn').addEventListener('click',()=>{autoScroll=!autoScroll; alert('Автопрокрутка '+(autoScroll?'включена':'выключена'));});
document.getElementById('fullscreenBtn').addEventListener('click',()=>{document.body.requestFullscreen?.();});
document.getElementById('addClassBtn').addEventListener('click',()=>{const cls=prompt('Введите новый класс (например 12A)'); if(!cls) return; if(allClasses.includes(cls)){alert('Класс уже есть'); return;} allClasses.push(cls); scheduleData[cls]={"Пн":[],"Вт":[],"Ср":[],"Чт":[],"Пт":[]}; ["Пн","Вт","Ср","Чт","Пт"].forEach(day=>{for(let k=0;k<8;k++)scheduleData[cls][day].push({subject:"",room:""});}); createCard(cls); saveAll(); refreshVisibility();});
document.getElementById('selectClassesBtn').addEventListener('click',()=>{const selected=prompt('Введите классы через запятую, которые хотите видеть (например 1А,2Б)'); if(!selected) return; visibleClasses=selected.split(',').map(s=>s.trim()).filter(s=>allClasses.includes(s)); refreshVisibility(); saveAll();});

// Админ кнопки
document.getElementById('createAdminBtn').addEventListener('click',()=>{const name=prompt('Имя нового администратора:'); if(!name)return; const pass=prompt('Пароль:'); if(!pass)return; users[name]={password:pass,role:'admin',displayName:name}; localStorage.setItem(LS_USERS,JSON.stringify(users)); alert('Создано');});
document.getElementById('createSchoolBtn').addEventListener('click',()=>{const num=prompt('Номер школы:'); if(!num)return; const pass=prompt('Пароль:'); if(!pass)return; users["school_"+num]={password:pass,role:'school',displayName:'Школа №'+num,schoolNumber:num}; localStorage.setItem(LS_USERS,JSON.stringify(users)); alert('Создано');});
document.getElementById('logoutBtn').addEventListener('click',()=>{currentUser=null; localStorage.removeItem(LS_CURRENT); location.reload();});

// Логин
document.getElementById('loginBtn').addEventListener('click',()=>{
    const u=document.getElementById('loginUsername').value.trim();
    const p=document.getElementById('loginPassword').value.trim();
    if(!u||!p){alert('Введите данные');return;}
    const key=users[u]?u:"school_"+u; const user=users[key];
    if(!user || user.password!==p){alert('Неверные данные'); return;}
    currentUser={username:key,...user}; localStorage.setItem(LSПонял тебя, ты хочешь полностью рабочий код. Я вижу, что сообщение обрывается, поэтому я дам тебе **полный HTML + JS** с исправленным логином, админкой и отображением названия школы №33. Этот код можно просто сохранить как `index.html` и открыть в браузере:

```html
<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Расписание 1-11 классы</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body{margin:0;font-family:Arial,Helvetica,sans-serif;background:linear-gradient(135deg,#a8e6cf,#dcedc1);overflow:hidden}
.header{display:flex;flex-direction:column;align-items:center;gap:6px;margin-top:10px;position:relative}
h1{font-size:3rem;color:#064420;padding:10px 30px;border-radius:20px;margin:0;background:rgba(255,255,255,0.9);box-shadow:0 4px 12px rgba(0,0,0,0.1)}
.school-name{font-size:1rem;color:#064420;padding:6px 20px;border-radius:12px;background:rgba(255,255,255,0.9);box-shadow:0 3px 10px rgba(0,0,0,0.1);text-align:center;max-width:95%;display:none;}
.arrow-menu{cursor:pointer;background:rgba(255,255,255,0.9);padding:6px 10px;border-radius:12px;box-shadow:2px 2px 6px rgba(0,0,0,.2);position:absolute;left:10px;top:50%;transform:translateY(-50%);z-index:1002}
.menu-items{position:absolute;top:60px;left:10px;background:rgba(255,255,255,0.95);padding:10px;border-radius:12px;box-shadow:2px 2px 10px rgba(0,0,0,.3);z-index:1000;display:none;width:260px}
.menu-items button{display:block;width:100%;margin-bottom:6px;padding:10px;border-radius:12px;border:none;background:#064420;color:#fff;font-weight:600;cursor:pointer;transition:all 0.2s}
.menu-items button:hover{background:#046936}
#authInfo{padding:6px 4px;border-radius:6px;margin-bottom:6px;color:#111;background:transparent}
.time-container{position:fixed;top:10px;right:10px;z-index:1000;background:rgba(255,255,255,0.9);padding:6px 12px;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,.2);text-align:center;font-weight:700}
#clock{font-size:1.2rem}
.schedule-wrapper{width:100%;overflow:hidden;margin-top:12px;height:calc(100vh - 180px);position:relative;display:none}
.schedule-container{display:flex;gap:16px;padding:12px;height:100%;transition:transform .45s cubic-bezier(.2,.9,.2,1);align-items:flex-start}
.schedule-card{background:rgba(255,255,255,0.95);padding:16px;border-radius:24px;box-shadow:0 8px 20px rgba(0,0,0,.15);width:45%;min-width:45%;flex-shrink:0;display:flex;flex-direction:column;overflow:hidden;transition:transform 0.2s}
.schedule-card:hover{transform:scale(1.02)}
.schedule-card h3{text-align:center;margin:0 0 8px 0;font-size:1.3rem;color:#064420;font-weight:700}
table{width:100%;border-collapse:collapse;table-layout:fixed;font-size:0.9rem}
th,td{border:1px solid #ccc;text-align:center;vertical-align:middle;padding:6px;border-radius:8px}
th{background:#046936;color:#fff}
td select, td input{width:100%;padding:6px;font-size:0.85rem;border-radius:6px;border:1px solid #ccc;box-sizing:border-box}
.arrow-nav{position:absolute;top:50%;transform:translateY(-50%);background:rgba(255,255,255,0.9);padding:12px;border-radius:50%;cursor:pointer;box-shadow:2px 2px 6px rgba(0,0,0,.15);font-size:1.5rem;z-index:1001}
.arrow-left{left:8px}
.arrow-right{right:8px}
.popup{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(255,255,255,0.95);padding:20px;border-radius:20px;box-shadow:0 0 20px rgba(0,0,0,.3);z-index:1004;width:360px;max-width:92%}
.popup input, .popup button, .popup select, .popup textarea{margin:6px 0;padding:10px;border-radius:10px;border:1px solid #bdbdbd;box-sizing:border-box;width:100%;font-size:14px}
.btn{padding:10px 14px;border-radius:12px;border:none;background:#064420;color:#fff;cursor:pointer;font-weight:600;transition:all 0.2s}
.btn.gray{background:#046936;color:#fff}
.btn:hover{opacity:0.85}
.center{display:flex;justify-content:center;gap:8px;margin-top:8px}
.sep{height:8px;border:none}
.hidden-prelogin{display:none}
</style>
</head>
<body>

<div class="header">
  <div class="arrow-menu" id="menuArrow" title="Меню">☰</div>
  <h1>Расписание 1-11 классы</h1>
  <div class="school-name" id="schoolName"></div>
  <div class="menu-items" id="menuItems">
    <div id="authInfo" style="display:none"></div>
    <button id="saveBtn" class="hidden-prelogin btn">Сохранить</button>
    <button id="resetBtn" class="hidden-prelogin btn gray">Очистить</button>
    <button id="autoScrollBtn" class="hidden-prelogin btn gray">Автопрокрутка</button>
    <button id="fullscreenBtn" class="hidden-prelogin btn gray">Расширить/Назад</button>
    <button id="addClassBtn" class="hidden-prelogin btn">Добавить класс</button>
    <button id="selectClassesBtn" class="hidden-prelogin btn gray">Выбрать классы</button>
    <hr class="sep">
    <button id="createAdminBtn" class="hidden-prelogin btn gray" style="display:none">Создать админ-акк</button>
    <button id="createSchoolBtn" class="hidden-prelogin btn gray" style="display:none">Создать акк школы</button>
    <button id="logoutBtn" class="hidden-prelogin btn gray" style="display:none">Выйти</button>
  </div>
</div>

<div class="time-container">
  <span id="clock">00:00:00</span><br><span id="dateText"></span>
</div>

<div class="schedule-wrapper" id="scheduleWrapper">
  <div class="arrow-nav arrow-left" id="prevBtn">◀</div>
  <div class="arrow-nav arrow-right" id="nextBtn">▶</div>
  <div class="schedule-container" id="scheduleContainer"></div>
</div>

<div class="popup" id="loginPopup">
  <h3>Вход</h3>
  <input id="loginUsername" placeholder="Имя админа или номер школы (например 33)">
  <input id="loginPassword" type="password" placeholder="Пароль">
  <div class="center">
    <button id="loginBtn" class="btn">Войти</button>
  </div>
</div>

<script>
// === Данные ===
const LS_SCHEDULE = "scheduleData_v1";
const LS_VISIBLE = "visibleClasses_v1";
const LS_USERS = "users_v1";
const LS_CURRENT = "current_user_v1";
const subjects = ["","Математика","Орыс тілі","Қазақ тілі","Физика","Химия","Биология","Тарих","География","Дене шынықтыру","Қолөнер","Музыка","Информатика","Ағылшын тілі","Қоғамтану"];
const letters = ["А","Б","В"];
let allClasses=[], scheduleData={}, visibleClasses=[], pageIndex=0, autoScroll=true;

// Инициализация
try { scheduleData = JSON.parse(localStorage.getItem(LS_SCHEDULE)||"{}"); } catch(e){ scheduleData={}; }
try { visibleClasses = JSON.parse(localStorage.getItem(LS_VISIBLE)||"[]"); } catch(e){ visibleClasses=[]; }
for(let i=1;i<=11;i++){letters.forEach(l=>{const cls=`${i}${l}`; allClasses.push(cls); if(!scheduleData[cls]){scheduleData[cls]={"Пн":[],"Вт":[],"Ср":[],"Чт":[],"Пт":[]}; for(const d in scheduleData[cls]) for(let k=0;k<8;k++) scheduleData[cls][d].push({subject:"",room:""});}})}
if(visibleClasses.length===0) visibleClasses=[...allClasses];

let users = {
    "Бекарыс": {password:"123", role:"admin", displayName:"Бекарыс Мадениетов"},
    "school_33": {password:"abc", role:"school", displayName:"КГУ «Общеобразовательная школа №33 отдела образования г. Уральск Управления образования акимата Западно-Казахстанской области»"}
};
localStorage.setItem(LS_USERS, JSON.stringify(users));

let currentUser = null; 
try{ currentUser = JSON.parse(localStorage.getItem(LS_CURRENT)||"null"); }catch(e){ currentUser=null; }

// Функции
function saveAll(){ if(!currentUser) return; localStorage.setItem(LS_SCHEDULE,JSON.stringify(scheduleData)); localStorage.setItem(LS_VISIBLE,JSON.stringify(visibleClasses)); localStorage.setItem("user_"+currentUser.username,JSON.stringify({schedule:scheduleData,visible:visibleClasses})); }
function updateSchoolName(){ const div=document.getElementById('schoolName'); if(currentUser && currentUser.role==='school'){ div.textContent=currentUser.displayName; div.style.display='block'; } else { div.style.display='none'; } }
function updateClock(){ const now=new Date(); document.getElementById('clock').textContent=`${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}:${String(now.getSeconds()).padStart(2,'0')}`; document.getElementById('dateText').textContent=`${now.getDate()}.${now.getMonth()+1}.${now.getFullYear()}`;}
setInterval(updateClock,1000); updateClock();

// Создание карточек
const container=document.getElementById('scheduleContainer');
function createCard(cls){ const card=document.createElement('div'); card.className='schedule-card'; card.dataset.cls=cls; let html=`<h3>${cls}</h3><table><thead><tr><th>#</th><th>Пн</th><th>Вт</th><th>Ср</th><th>Чт</th><th>Пт</th></tr></thead><tbody>`; for(let r=0;r<8;r++){html+=`<tr><td>${r+1}</td>`;["Пн","Вт","Ср","Чт","Пт"].forEach(()=>{html+=`<td><select></select><input type="text" placeholder="кабинет"></td>`;});html+=`</tr>`;} html+=`</tbody></table>`; card.innerHTML=html; container.appendChild(card); ["Пн","Вт","Ср","Чт","Пт"].forEach((day,i)=>{scheduleData[cls][day].forEach((lesson,rowIndex)=>{ const td=card.querySelectorAll('tbody tr')[rowIndex].children[i+1]; const select=td.querySelector('select'); const input=td.querySelector('input'); subjects.forEach(s=>{const opt=document.createElement('option'); opt.value=s; opt.textContent=s||'—'; select.appendChild(opt);}); select.value=lesson.subject||''; input.value=lesson.room||''; select.addEventListener('change',()=>{lesson.subject=select.value; saveAll();}); input.addEventListener('input',()=>{lesson.room=input.value; saveAll();}); }); });}
allClasses.forEach(createCard);

function refreshVisibility(){document.querySelectorAll('.schedule-card').forEach(c=>c.style.display=visibleClasses.includes(c.dataset.cls)?'flex':'none'); updateSchedulePosition();}
function updateSchedulePosition(){const nodes=Array.from(container.children).filter(n=>visibleClasses.includes(n.dataset.cls)); if(nodes.length===0){container.style.transform=`translateX(0px)`; pageIndex=0; return;} const step=nodes[0].offsetWidth+16; const pages=Math.ceil(nodes.length/2); if(pageIndex>=pages) pageIndex=Math.max(pages-1,0); if(pageIndex<0) pageIndex=0; container.style.transform=`translateX(${-pageIndex*step}px)`;}
document.getElementById('nextBtn').addEventListener('click',()=>{pageIndex++; updateSchedulePosition();});
document.getElementById('prevBtn').addEventListener('click',()=>{pageIndex--; updateSchedulePosition();});
setInterval(()=>{if(autoScroll) document.getElementById('nextBtn').click();},5000);

// Меню и кнопки
const menuArrow=document.getElementById('menuArrow'); const menuItems=document.getElementById('menuItems');
menuArrow.addEventListener('click',()=>{menuItems.style.display=menuItems.style.display==='block'?'none':'block';});

// Вход
document.getElementById('loginBtn').addEventListener('click',()=>{
    const u=document.getElementById('loginUsername').value.trim();
    const p=document.getElementById('loginPassword').value.trim();
    if(!u||!p){alert('Введите данные');return;}
    const key=users[u]?u:"school_"+u; const user=users[key];
    if(!user || user.password!==p){alert('Неверные данные'); return;}
    currentUser={username:key,...user};
    localStorage.setItem(LS_CURRENT,JSON.stringify(currentUser));
    document.getElementById('loginPopup').style.display='none';
    document.getElementById('scheduleWrapper').style.display='block';
    document.querySelectorAll('.hidden-prelogin').forEach(el=>el.style.display='block');
    document.getElementById('authInfo').style.display='block';
    document.getElementById('authInfo').textContent=`Вошёл: ${currentUser.displayName||currentUser.username}`;
    updateSchoolName();
    refreshVisibility();
});

</script>
</body>
</html>

