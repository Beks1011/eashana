<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ 1‚Äì11 –∫–ª–∞—Å—Å—ã</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>

<style>
body{margin:0;font-family:Arial;background:linear-gradient(135deg,#a8e6cf,#dcedc1)}
.header{text-align:center;padding:10px;position:relative}
h1{background:white;padding:10px 30px;border-radius:20px;display:inline-block}
.school{margin-top:6px;background:white;padding:6px 14px;border-radius:12px;display:none}
.menu{position:absolute;left:10px;top:15px;cursor:pointer;background:white;padding:8px;border-radius:10px}
.schedule{display:none;padding:10px}
.cards{display:flex;gap:20px;overflow:hidden}
.card{background:white;border-radius:20px;padding:10px;width:45%;min-width:45%}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #ccc;padding:4px;text-align:center}
th{background:#046936;color:white}
.login{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
background:white;padding:20px;border-radius:20px;width:300px}
.login input{width:100%;margin-bottom:10px;padding:8px}
</style>
</head>

<body>

<div class="header">
  <div class="menu" onclick="logout()">‚éã</div>
  <h1>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ 1‚Äì11 –∫–ª–∞—Å—Å—ã</h1>
  <div class="school" id="schoolName"></div>
</div>

<div class="schedule" id="schedule">
  <div class="cards" id="cards"></div>
</div>

<div class="login" id="login">
  <h3>–í—Ö–æ–¥</h3>
  <input id="user" placeholder="–ª–æ–≥–∏–Ω –∏–ª–∏ –Ω–æ–º–µ—Ä —à–∫–æ–ª—ã">
  <input id="pass" type="password" placeholder="–ø–∞—Ä–æ–ª—å">
  <button onclick="login()">–í–æ–π—Ç–∏</button>
</div>

<script>
// üîë –í–°–¢–ê–í–¨ –°–í–û–ò –î–ê–ù–ù–´–ï SUPABASE
const supabase = supabaseJs.createClient(
  "https://YOUR_PROJECT_ID.supabase.co",
  "YOUR_PUBLIC_ANON_KEY"
);

const subjects=["","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ","–û—Ä—ã—Å —Ç—ñ–ª—ñ","–§–∏–∑–∏–∫–∞","–•–∏–º–∏—è","–ë–∏–æ–ª–æ–≥–∏—è"];
const classes=[];
for(let i=1;i<=11;i++)["–ê","–ë"].forEach(l=>classes.push(i+l));

let currentUser=null;

async function login(){
  const u=user.value.trim();
  const p=pass.value.trim();

  const { data } = await supabase
    .from("users")
    .select("*")
    .eq("username",u)
    .eq("password",p)
    .single();

  if(!data){ alert("–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞"); return; }

  currentUser=data;
  loginDiv.style.display="none";
  schedule.style.display="block";

  if(data.role==="school"){
    schoolName.innerText=data.school_name;
    schoolName.style.display="block";
  }

  render();
}

async function render(){
  cards.innerHTML="";
  for(const c of classes){
    let html=`<div class="card"><h3>${c}</h3><table><tr>
    <th>#</th><th>–ü–Ω</th><th>–í—Ç</th><th>–°—Ä</th><th>–ß—Ç</th><th>–ü—Ç</th></tr>`;

    for(let i=1;i<=6;i++){
      html+=`<tr><td>${i}</td>`;
      for(const d of ["–ü–Ω","–í—Ç","–°—Ä","–ß—Ç","–ü—Ç"]){
        const { data } = await supabase
          .from("schedule")
          .select("subject")
          .eq("class",c)
          .eq("day",d)
          .eq("lesson",i)
          .single();

        html+=`<td>
          <select onchange="save('${c}','${d}',${i},this.value)">
            ${subjects.map(s=>`<option ${data?.subject===s?"selected":""}>${s}</option>`).join("")}
          </select>
        </td>`;
      }
      html+="</tr>";
    }

    html+="</table></div>";
    cards.innerHTML+=html;
  }
}

async function save(cls,day,lesson,subject){
  await supabase.from("schedule").upsert({
    class:cls,
    day:day,
    lesson:lesson,
    subject:subject
  });
}

function logout(){
  location.reload();
}
</script>

</body>
</html>

